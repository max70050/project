<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hilfe-Plattform (Demo)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="wrap">
      <h1 class="logo"><a href="#home">Hilfe-Plattform</a></h1>
      <p class="tagline">Jugendliche helfen – Senioren bekommen Unterstützung</p>
    </div>
  </header>

<nav class="site-nav">
  <div class="wrap">
    <a href="#home">Anzeigen</a>
    <a href="#watchlist" data-requires-auth hidden>Beobachtungsliste</a>
    <a href="#myAds" data-requires-auth hidden>Deine Anzeigen</a>
    <a href="#nachrichten" data-requires-auth hidden>
      Nachrichten <span id="nav-message-counter" class="notification-counter" hidden>0</span>
    </a>
    <a href="#stats" data-admin-only hidden>Statistiken</a>
    <a href="#about">Über uns</a>
    <a href="#new" class="cta" data-requires-auth hidden>Anzeige erstellen</a>

    <div class="nav-auth">
        <div id="notification-bell-container" class="notification-bell-container" hidden>
            <button id="notification-bell-btn" class="notification-bell" aria-label="Benachrichtigungen">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
                <span id="notification-counter" class="notification-counter" hidden>0</span>
            </button>
            <div id="notifications-panel" class="notifications-panel" hidden>
                <div class="notifications-header">
                    <h3>Benachrichtigungen</h3>
                </div>
                <div id="notifications-list" class="notifications-list">
                    </div>
                <p id="notifications-empty" class="empty-hint" style="margin: 20px 0;">Keine neuen Benachrichtigungen.</p>
            </div>
        </div>
        <a href="#profile" id="user-profile-nav" class="user-profile-link" hidden>
            <img id="nav-avatar" src="" alt="Mein Avatar" class="nav-avatar">
            <span id="user-status-text"></span>
        </a>
        <a href="#" id="auth-btn" class="cta secondary">Anmelden</a>
    </div>
  </div>
</nav>

  <main class="wrap">
    <section id="view-home" class="view">
      <h2>Aktuelle Anzeigen</h2>

      <div class="filters">
        <label>
          Kategorie
          <select id="filter-category">
            <option value="">Alle</option>
            <option>Gartenarbeit</option>
            <option>Einkaufen</option>
            <option>Haushalt</option>
            <option>Technik</option>
            <option>Sonstiges</option>
          </select>
        </label>
        <label>
          Stadt/Ort
          <input id="filter-location" type="text" placeholder="z. B. Köln" />
        </label>
        <button id="btn-clear-filters" type="button">Filter zurücksetzen</button>
      </div>

      <div id="ads-list" class="ads-list"></div>
      <p id="home-empty" class="empty-hint" hidden>Keine Anzeigen gefunden.</p>
    </section>


<section id="view-about" class="page-content" hidden>
  <div class="about-container">
    <h2>Über uns</h2>
    <p>Unsere Plattform bringt Generationen zusammen: Jugendliche, die sich etwas dazuverdienen möchten, und Erwachsene, die im Alltag Unterstützung brauchen. Wir sind die Brücke für gegenseitige Hilfe in deiner Nachbarschaft.</p>

    <div class="about-section">
      <h3>Für Jugendliche</h3>
      <p>Du möchtest dir dein Taschengeld aufbessern und dabei etwas Gutes tun? Auf dieser Plattform findest du eine Vielzahl von Anzeigen von Erwachsenen in deiner Nähe, die Hilfe benötigen. Du kannst einfach durch die verschiedenen Kategorien stöbern, die Anzeigen anschauen und direkt mit den Hilfesuchenden in Kontakt treten. Besprecht die Details, einigt euch auf einen Preis und helft, wo ihr könnt!</p>
    </div>

    <div class="about-section">
      <h3>Für Erwachsene</h3>
      <p>Du brauchst Hilfe im Haushalt, im Garten oder bei technischen Problemen? Statt stundenlang nach professionellen Dienstleistern zu suchen, kannst du hier ganz einfach eine Anzeige erstellen. Beschreibe, welche Hilfe du brauchst – von Gartenarbeit bis zur Einrichtung deines neuen Smartphones – und lass dich von motivierten Jugendlichen aus deiner Umgebung unterstützen. Es ist eine einfache und unkomplizierte Möglichkeit, genau die Unterstützung zu finden, die du benötigst.</p>
    </div>

    <div class="about-section">
      <h3>Unsere Kategorien</h3>
      <p>Um die passende Hilfe schnell zu finden, haben wir unsere Anzeigen in klare Kategorien unterteilt:</p>
      <ul class="category-list">
        <li><span class="icon">🌱</span><div><strong>Gartenarbeit:</strong> Von Rasenmähen über Unkrautjäten bis hin zum Aufbau eines Gartenhauses.</div></li>
        <li><span class="icon">🛒</span><div><strong>Einkaufen:</strong> Du brauchst Unterstützung bei deinen täglichen Besorgungen oder möchtest, dass dir jemand etwas vom Supermarkt mitbringt?</div></li>
        <li><span class="icon">🏠</span><div><strong>Haushalt:</strong> Ob Schränke aufbauen, schwere Gegenstände tragen oder bei der Reinigung helfen.</div></li>
        <li><span class="icon">💻</span><div><strong>Technik:</strong> Hilfe bei der Einrichtung des neuen Handys, des Tablets oder bei Computerproblemen.</div></li>
        <li><span class="icon">✨</span><div><strong>Sonstiges:</strong> Für alle Aufgaben, die in keine der anderen Kategorien passen.</div></li>
      </ul>
    </div>

    <div class="contact-area">
      <h3>Noch Fragen?</h3>
      <p>Für Anregungen oder Probleme kannst du uns jederzeit eine E-Mail schicken. Wir versuchen, schnellstmöglich zu antworten:</p>
      <p><strong><a href="mailto:help4you0101@gmail.com">help4you0101@gmail.com</a></strong></p>
    </div>
  </div>
</section>




    <section id="view-detail" class="view" hidden>
      <button id="btn-back" class="btn-link" type="button">← Zurück</button>
      <article id="detail-card" class="detail-card"></article>
    </section>

    <section id="view-public-profile" class="view" hidden>
      <button id="btn-back-from-profile" class="btn-link" type="button">← Zurück zur Anzeige</button>
      <div id="public-profile-header">
        <img id="public-profile-avatar" src="" alt="Profilbild" class="profile-avatar-preview" style="width: 80px; height: 80px;">
        <div class="public-profile-info">
          <h2 id="public-profile-username"></h2>
          <p id="public-profile-ad-count"></p>
          <div id="public-profile-stats" class="public-profile-meta-stats"></div>
        </div>
        <div id="follow-button-container" class="follow-button-container"></div>
        <div id="public-profile-menu-container" class="detail-header-actions"></div>
      </div>
      <h3>Anzeigen von diesem Nutzer</h3>
      <div id="public-profile-ads-list" class="ads-list"></div>
      <p id="public-profile-no-ads" class="empty-hint" hidden>Dieser Nutzer hat aktuell keine aktiven Anzeigen.</p>
    </section>

    <section id="view-watchlist" class="view" hidden>
      <h2>Beobachtungsliste</h2>
      <div id="watch-list" class="ads-list"></div>
      <p id="watch-empty" class="empty-hint" hidden>Noch keine Anzeigen in der Beobachtungsliste.</p>
    </section>

    <section id="view-new" class="view" hidden>
      <h2>Neue Anzeige erstellen</h2>
      <form id="ad-form" class="form-grid" autocomplete="off">

        <div id="profile-incomplete-warning" hidden>
    <div class="privacy-note" style="background-color: #fff9c4; border-left-color: #fdd835;">
        <p style="margin: 0;"><strong>Bitte vervollständige zuerst dein Profil</strong>, bevor du eine Anzeige erstellen kannst. Alle Felder werden benötigt.</p>
        <a href="#profile" id="link-to-profile" class="button small" style="margin-top: 10px; background-color: #fbc02d; color: var(--ink);">Zum Profil</a>
    </div>
</div>
        <label>
  Titel
  <input id="f-title" type="text" required placeholder="z. B. Schnee schippen" minlength="10" maxlength="35" />
</label>

        <label>
  Stadt/Ort
  <input id="f-location" type="text" required placeholder="z. B. Köln Gladbach" maxlength="30" />
</label>
        <label>
          Kategorie
          <select id="f-category" required>
            <option value="" disabled selected>Bitte wählen</option>
            <option>Gartenarbeit</option>
            <option>Einkaufen</option>
            <option>Haushalt</option>
            <option>Technik</option>
            <option>Sonstiges</option>
          </select>
        </label>

        <label>
          Schwierigkeitsgrad
          <select id="f-difficulty" required>
            <option value="" disabled selected>Bitte wählen</option>
            <option>leicht</option>
            <option>mittel</option>
            <option>anstrengend</option>
          </select>
        </label>



        <label>
          Bezahlung
          <select id="f-payment-type" required>
            <option value="fest" selected>Festpreis (€)</option>
            <option value="vb">Verhandlungsbasis</option>
          </select>
        </label>

        <div id="price-input-container">
          <label id="price-label">
          Betrag in €
          <input id="f-payment" type="number" min="0" max="150" step="1" inputmode="numeric" placeholder="z. B. 15 (max.150)" />
        </label>
        </div>

               <label>
  Ungefähre Dauer / Fläche
  <input id="f-size" type="text" placeholder="z. B. ca. 2 Std. oder 20 m²" maxlength="30" />
</label>

        <div class="span-2">
            <label>Werden Geräte/Werkzeuge gestellt?</label>
            <div class="radio-group">
                <label>
                    <input type="radio" name="f-tools" value="Ja" required>
                    <span>Ja</span>
                </label>
                <label>
                    <input type="radio" name="f-tools" value="Nein">
                    <span>Nein</span>
                </label>
                <label>
                    <input type="radio" name="f-tools" value="Nach Absprache">
                    <span>Nach Absprache</span>
                </label>
            </div>
        </div>
        <div class="span-2">
          <label>Bilder hinzufügen</label>
          <div class="upload-actions">
            <button type="button" id="btn-pick-gallery" class="secondary">Aus Galerie wählen</button>
            <button type="button" id="btn-pick-camera" class="secondary">Foto aufnehmen</button>
          </div>
          <small id="image-upload-hint" class="field-hint error" hidden></small>
          <input id="f-images" type="file" accept="image/*" multiple hidden />
          <input id="f-images-camera" type="file" accept="image/*" capture="environment" multiple hidden />
          <div id="preview-container" class="preview-container" data-sortable>
              <p class="drop-hint">Hier werden deine Bilder angezeigt. Du kannst sie per Drag & Drop sortieren.</p>
          </div>
        </div>

        <label class="span-2">
          Beschreibung
          <textarea id="f-desc" rows="5" required minlength="20" maxlength="500" placeholder="Beschreibe kurz, wobei Hilfe gebraucht wird (min. 20, max. 500 Zeichen)"></textarea>
        </label>

        <div class="form-actions span-2">
          
          <button type="submit">Anzeige speichern</button>
          <button id="btn-discard" type="button" class="secondary">Verwerfen</button>
        </div>
      </form>

      <p class="note">
        <em>Falls du deine Anzeige nicht speichern kannst, überprüfe bitte ob du alles Vollständig ausgefüllt hast.</em>
      </p>
    </section>

    <section id="view-my-ads" class="view" hidden>
      <h2>Deine Anzeigen</h2>
      <div id="my-ads-list" class="ads-list"></div>
      <p id="my-ads-empty" class="empty-hint" hidden>Du hast noch keine Anzeigen erstellt.</p>
    </section>

    <section id="view-nachrichten" class="view view-chat" hidden>
  <div class="chat-container">
    <div id="chat-list-panel" class="chat-list-panel">
      <div class="chat-list-header">
        <h2>Nachrichten</h2>
      </div>
      <div id="chat-list-container" class="chat-list-container">
        </div>
      <p id="chat-list-empty" class="empty-hint" hidden>Du hast noch keine Chats.</p>
    </div>

    <div id="active-chat-panel" class="active-chat-panel">
      <div id="chat-welcome-screen" class="chat-welcome-screen">
         <div style="text-align: center;">
          <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" style="color: var(--muted);"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
          <h3 style="margin-top: 10px;">Deine Nachrichten</h3>
          <p>Wähle einen Chat aus, um die Unterhaltung zu beginnen.</p>
      </div>
      </div>
     <div id="chat-content-area" class="chat-content-area" >
        <div class="chat-header">
          <button id="btn-back-to-chat-list" class="btn-link" aria-label="Zurück zur Chat-Liste">←</button>
          <div id="chat-header-userinfo" class="chat-header-userinfo">
            <img id="chat-header-avatar" src="" alt="Avatar" class="chat-header-avatar">
            <span id="chat-header-username"></span>
          </div>
        
          <div class="chat-header-actions">
            <button id="chat-menu-btn" class="menu-toggle-btn" aria-label="Weitere Optionen"></button>
            <div id="chat-detail-menu" class="detail-menu">
               <button class="detail-menu-item danger" id="chat-block-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line></svg>
        <span>Benutzer blockieren</span>
        </button>
              <button class="detail-menu-item danger" id="chat-report-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                <span>Benutzer melden</span>
              </button>
            </div>
          </div>
        </div>

       
        <div id="chat-messages" class="chat-messages">
          </div>
        <form id="chat-form" class="chat-form">
            <div class="chat-actions-container">
                <button type="button" id="chat-attach-btn" class="chat-action-btn" aria-label="Anhang hinzufügen">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                </button>
                <div id="chat-attach-menu" class="chat-attach-menu" hidden>
                    <button type="button" id="btn-send-image" class="chat-menu-item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                        <span>Bild</span>
                    </button>
                    <button type="button" id="btn-send-address" class="chat-menu-item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                        <span>Adresse</span>
                    </button>
                </div>
            </div>
            <input type="file" id="chat-image-upload" accept="image/*" hidden>
            <input type="text" id="chat-message-input" placeholder="Nachricht schreiben..." autocomplete="off">
            <button type="submit" id="chat-send-btn" class="chat-action-btn" aria-label="Senden">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
            </button>
        </form>
      </div>
    </div>
  </div>
</section>

    <section id="view-stats" class="view" hidden>
        <h2>Statistiken & Admin-Tools</h2>
        <div class="admin-container">
            <div class="admin-stats-panel span-2">
                <h3>Übersicht</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="stats-active-ads">...</span>
                        <span class="stat-label">Aktive Anzeigen</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stats-total-users">...</span>
                        <span class="stat-label">Registrierte Benutzer</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stats-total-ads">...</span>
                        <span class="stat-label">Anzeigen insgesamt</span>
                    </div>
                </div>
            </div>

            <div id="reported-users-panel" class="span-2">
                <h3>Gemeldete Benutzer</h3>
                <div id="reported-users-list"></div>
                <p id="reported-users-empty" class="empty-hint" hidden>Aktuell gibt es keine neuen Benutzermeldungen.</p>
            </div>
    
            <div id="reported-ads-panel" class="span-2">
                <h3>Gemeldete Anzeigen</h3>
                <div id="reported-ads-list"></div>
                <p id="reported-ads-empty" class="empty-hint" hidden>Aktuell gibt es keine neuen Anzeigenmeldungen.</p>
            </div>
    
            <div class="admin-search-panel">
                <h3>Anzeige per ID suchen</h3>
                <p>Finde jede Anzeige (auch gelöschte) über ihre eindeutige ID.</p>
                <form id="admin-search-form" class="admin-search-form">
                    <input type="text" id="admin-search-input" placeholder="z.B. AD-ID-A1B2C" required>
                    <button type="submit">Suchen</button>
                </form>
            </div>

            <div class="admin-search-panel">
                <h3>Benutzer per Namen suchen</h3>
                <p>Finde einen Benutzer, um dessen E-Mail zu sehen oder das Konto zu sperren.</p>
                <form id="admin-user-search-form" class="admin-search-form">
                    <input type="text" id="admin-user-search-input" placeholder="z.B. max_mustermann" required>
                    <button type="submit">Suchen</button>
                </form>
                <div id="admin-user-search-results"></div>
                <p id="admin-user-search-empty" class="empty-hint" hidden>Kein Benutzer mit diesem Namen gefunden.</p>
            </div>

              <div id="pending-review-users-panel" class="span-2">
                <h3>Benutzernamen zur Überprüfung</h3>
                <p>Diese Benutzernamen enthalten potenziell problematische Begriffe und sollten manuell überprüft werden.</p>
                <div id="pending-review-users-list"></div>
                <p id="pending-review-users-empty" class="empty-hint" hidden>Keine Benutzernamen zur Überprüfung gefunden.</p>
            </div>

              <div id="unverified-users-panel" class="span-2">
            <h3>Unbestätigte Konten (älter als 24 Std.)</h3>
            <p>Diese Konten wurden erstellt, aber die E-Mail-Adresse wurde nicht innerhalb von 24 Stunden bestätigt. Sie können gefahrlos gelöscht werden.</p>
            <div id="unverified-users-list"></div>
            <p id="unverified-users-empty" class="empty-hint" hidden>Keine unbestätigten Konten gefunden.</p>
        </div>
       

    
            <div class="admin-deleted-panel">
                <h3>Zuletzt deaktivierte Anzeigen (letzte 50)</h3>
                <div id="deleted-ads-list"></div>
                <p id="deleted-ads-empty" class="empty-hint" hidden>Es wurden noch keine Anzeigen deaktiviert.</p>
            </div>
    
            <div class="admin-old-deleted-panel span-2">
                <h3>Endgültig löschen</h3>
                <p>
                    Diese Anzeigen wurden vor mehr als 60 Tagen deaktiviert und können nun permanent vom Server entfernt werden. <strong>Diese Aktion kann nicht rückgängig gemacht werden.</strong>
                </p>
                <div id="old-deleted-ads-list"></div>
                <p id="old-deleted-ads-empty" class="empty-hint" hidden>Keine Anzeigen gefunden, die älter als 60 Tage sind.</p>
            </div>
        </div>
        <p class="empty-hint" id="stats-no-admin-hint">Diese Seite ist nur für Administratoren sichtbar.</p>
    </section>
    
    <section id="view-profile" class="view" hidden>
        <h2>Mein Profil</h2>
        <div class="profile-content-wrapper"> <form id="profile-form" class="profile-grid">
                <div class="profile-avatar-container span-2">
                    <img id="p-avatar-preview" src=""  class="profile-avatar-preview">
                    <div class="profile-avatar-actions">
                        <label for="p-avatar-upload" class="button small secondary">Bild ändern</label>
                        <input type="file" id="p-avatar-upload" accept="image/png, image/jpeg" hidden>
                        <button type="button" id="btn-delete-avatar" class="button small danger" hidden>Entfernen</button>
                    </div>
                </div>

                <div id="color-palette-container" class="color-palette-container span-2">
                    <label>Avatar-Farbe wählen</label>
                    <div id="avatar-color-palette" class="color-palette"></div>
                </div>

                <div class="span-2">
                    <p class="privacy-note">
                        Deine Daten sind sicher. Nur dein Benutzername ist für andere sichtbar. Alle anderen Informationen sind privat.
                    </p>
                </div>

                <label>
                    E-Mail-Adresse
                    <input type="email" id="p-email" disabled placeholder="E-Mail-Adresse">
                </label>

                <label>
                    Passwort
                    <input type="password" id="p-password" disabled value="**********">
                </label>

                <label>
                    Benutzername
                    <input type="text" id="p-username" required minlength="3" maxlength="20">
                    <small id="username-hint" class="field-hint" hidden>Du kannst deinen Benutzernamen 2-mal alle 30 Tage ändern.</small>
                </label>
                
                <span></span> <label>
                    Vorname
                    <input type="text" id="p-firstname" placeholder="Dein Vorname" maxlength="50">
                </label>

                <label>
                    Nachname
                    <input type="text" id="p-lastname" placeholder="Dein Nachname" maxlength="50">
                </label>

                <div class="address-section span-2">
                  <h3>Adresse</h3>
                  <div class="address-fields">
                      <label class="street-field">
                          Straße und Hausnummer
                          <input type="text" id="p-street" placeholder="Musterstraße 1" maxlength="100">
                      </label>
          
                      <label>
                          Postleitzahl
                          <input type="number" inputmode="numeric" pattern="[0-9]*" id="p-zip" placeholder="12345" maxlength="10">
                      </label>
          
                      <label>
                          Ort
                          <input type="text" id="p-city" placeholder="Musterstadt" maxlength="50">
                      </label>
                  </div>
                </div>

                <div class="form-actions span-2">
                    <button type="submit">Änderungen speichern</button>
                    <button id="btn-discard-profile" type="button" class="secondary">Verwerfen</button>
                </div>
            </form>

            <div class="danger-zone">
                <h3>Konto Löschen</h3>
                <div class="danger-zone-item">
                    <div>
                        <strong>Konto endgültig löschen</strong>
                        <p>Diese Aktion ist endgültig und kann nicht rückgängig gemacht werden. Alle deine Daten und Anzeigen werden permanent entfernt.</p>
                    </div>
                    <button id="btn-delete-account" class="button danger">Konto löschen</button>
                </div>
            </div>
            </div>
    </section>

  
  <section id="view-report-reason" class="view" hidden>
    <button id="btn-back-from-report-reason" class="btn-link" type="button">← Zurück</button>
    <h2 id="report-reason-title">Anzeige melden</h2>
    <p>Bitte wähle einen Grund für die Meldung aus. Deine Meldung ist anonym.</p>
    
    <div id="report-chat-warning" class="privacy-note" hidden>
        <b>Hinweis:</b> Da du diesen Nutzer aus einem Chat meldest, werden die letzten 10 Nachrichten dieses Chats zur Überprüfung an die Moderation übermittelt.
    </div>

    <form id="report-reason-form" class="report-form">
        <div class="radio-group vertical" id="report-reasons-ad">
            <label><input type="radio" name="report-reason" value="unpassender-inhalt" required> Unpassender Inhalt</label>
            <label><input type="radio" name="report-reason" value="anstoessig-beleidigend"> Anstößiger oder beleidigender Inhalt</label>
            <label><input type="radio" name="report-reason" value="gewerblich"> Mutmaßlich gewerblicher Anbieter</label>
            <label><input type="radio" name="report-reason" value="betrug-verdaechtig"> Verdächtiger oder betrügerischer Inhalt</label>
            <label><input type="radio" name="report-reason" value="faelschung"> Fälschung</label>
            <label><input type="radio" name="report-reason" value="sonstiges"> Sonstiges</label>
        </div>
        <div class="radio-group vertical report-group-hidden" id="report-reasons-user">
            <label><input type="radio" name="report-reason-user" value="verdaechtiges-verhalten" required> Verdächtiges oder betrügerisches Verhalten</label>
            <label><input type="radio" name="report-reason-user" value="belaestigung"> Belästigung</label>
            <label><input type="radio" name="report-reason-user" value="gewerblich"> Mutmaßlich gewerblicher Anbieter</label>
            <label><input type="radio" name="report-reason-user" value="kindesmissbrauch"> Kindesmissbrauch oder -gefährdung</label>
            <label><input type="radio" name="report-reason-user" value="beleidigung"> Beleidigung</label>
            <label><input type="radio" name="report-reason-user" value="sonstiges"> Sonstiges</label>
        </div>
        <div class="form-actions">
            <button type="submit">Weiter</button>
            <button type="button" id="btn-cancel-report-1" class="secondary">Abbrechen</button>
        </div>
    </form>
</section>

    <section id="view-report-details" class="view" hidden>
        <button id="btn-back-from-report-details" class="btn-link" type="button">← Zurück zur Auswahl</button>
        <h2>Grund für die Meldung</h2>
        <p>Bitte beschreibe möglichst genau, warum du diese Meldung machst.</p>
        <form id="report-details-form" class="report-form">
            <textarea id="report-description" rows="6" placeholder="Deine Beschreibung (optional)" maxlength="1000"></textarea>
            <div class="form-actions">
                <button type="submit">Meldung absenden</button>
                <button type="button" id="btn-cancel-report-2" class="secondary">Abbrechen</button>
            </div>
        </form>
    </section>

  </main>

  <footer class="site-footer">
    <div class="wrap">
      <small>© 2025 Hilfe-Plattform (Demo)</small>
    </div>
  </footer>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <div id="auth-modal" class="modal-overlay" hidden>
    <div class="modal-content">
      <button id="close-modal-btn" class="close-btn" aria-label="Schließen">&times;</button>
      <div id="login-view">
        <h2>Anmelden</h2>
        <form id="login-form">
          <label>Email <input type="email" id="login-email" required></label>
          <label>
            Passwort
            <div class="password-wrapper">
              <input type="password" id="login-password" required>
              <button type="button" id="toggle-login-password" class="password-toggle" aria-label="Passwort anzeigen">
                </button>
            </div>
          </label>
          <button type="submit">Anmelden</button>
          <p style="text-align: center; margin-top: 15px; font-size: 0.9em;">
            <a href="#" id="forgot-password-link">Passwort vergessen?</a>
          </p>
        </form>
        <p>Noch kein Konto? <a href="#" id="show-register">Jetzt registrieren</a></p>
      </div>
      <div id="register-view" hidden>
        <h2>Registrieren</h2>
        <form id="register-form">
         <label>Nutzername
  <input type="text" id="register-username" required minlength="3" maxlength="20">
  <small id="register-username-hint" class="field-hint" hidden></small>
</label>
          <label>Email <input type="email" id="register-email" required></label>
          <label>
  Passwort
  <div class="password-wrapper">
    <input type="password" id="register-password" required minlength="8">
    <button type="button" id="toggle-register-password" class="password-toggle" aria-label="Passwort anzeigen"></button>
  </div>
  <div id="password-criteria" style="font-size: 0.8em; font-weight: normal; margin-top: 8px; color: var(--muted);" hidden>
    <p id="pw-length">Mindestens 8, max. 16 Zeichen</p>
    <p id="pw-uppercase">Mindestens ein Großbuchschtabe </p>
    <p id="pw-number">Mindestens eine Zahl </p>
  </div>
</label>
          <button type="submit">Registrieren</button>
        </form>
        <p>Bereits ein Konto? <a href="#" id="show-login">Zum Login</a></p>
      </div>
    </div>
  </div>

  <div id="reset-confirm-modal" class="modal-overlay" hidden>
    <div class="modal-content" style="text-align: center;">
      <h2>E-Mail versendet</h2>
      <p>Wir haben eine E-Mail zum Zurücksetzen deines Passworts an die angegebene Adresse gesendet.</p>
      <p style="font-weight: bold;">Bitte überprüfe auch deinen Spam-Ordner!</p>
      <div id="resend-container" style="margin-top: 20px; min-height: 40px;">
        </div>
      <button id="close-confirm-modal-btn" class="secondary" style="margin-top: 10px;">Schließen</button>
    </div>
  </div>

  <div id="verify-email-modal" class="modal-overlay" hidden>
    <div class="modal-content" style="text-align: center;">
      <h2>Bestätigung erforderlich</h2>
      <p>Wir haben dir eine E-Mail gesendet. Bitte klicke auf den Link in der E-Mail, um dein Konto zu aktivieren.</p>
      <p>Nachdem du deine E-Mail erfolgreich Verifiziert hast, kannst du diese Fenster schließen und dich anmelden.</p>
      <p style="font-weight: bold;">Überprüfe bitte auch deinen Spam-Ordner!</p>
      <button id="close-verify-modal-btn" class="secondary" style="margin-top: 10px;">Schließen</button>
    </div>
  </div>

  <div id="confirm-modal" class="modal-overlay" hidden>
    <div class="modal-content" style="max-width: 420px; text-align: center;">
        <h2 id="confirm-modal-title">Wirklich löschen?</h2>
        <p id="confirm-modal-text">Bist du sicher, dass du diese Aktion ausführen möchtest? Dies kann nicht rückgängig gemacht werden.</p>
        <div class="form-actions" style="justify-content: center; margin-top: 20px;">
            <button id="confirm-modal-confirm-btn" class="danger">Löschen</button>
            <button id="confirm-modal-cancel-btn" class="secondary">Abbrechen</button>
        </div>
    </div>
  </div>

  <div id="share-modal" class="modal-overlay" hidden>
    <div class="modal-content">
        <button id="close-share-modal-btn" class="close-btn" aria-label="Schließen">&times;</button>
        <h2 id="share-modal-title">Anzeige teilen</h2>
        <p>Teile diesen Link, um die Information weiterzugeben.</p>
        <div class="share-link-container">
            <input type="text" id="share-link-input" readonly>
            <button id="copy-share-link-btn">Kopieren</button>
        </div>
        <div class="share-socials">
            <a id="share-whatsapp" href="#" target="_blank">WhatsApp</a>
            <a id="share-email" href="#">E-Mail</a>
        </div>
    </div>
  </div>

  <div id="admin-report-modal" class="modal-overlay" hidden>
      <div class="modal-content" style="max-width: 550px;">
          <button id="close-admin-report-modal-btn" class="close-btn" aria-label="Schließen">&times;</button>
          <h2>Meldung überprüfen</h2>
          <div id="admin-report-details">
            <p><strong>Anzeige:</strong> <span id="admin-report-ad-title"></span></p>
            <p><strong>Grund:</strong> <span id="admin-report-reason"></span></p>
            <p><strong>Beschreibung:</strong></p>
            <div id="admin-report-description"></div>
          </div>
          <div class="form-actions" style="margin-top: 20px; justify-content: space-between;">
              <button id="admin-delete-ad-btn" class="danger">Anzeige löschen</button>
              <button id="admin-view-ad-btn" type="button" class="secondary">Anzeige ansehen</button>
              <button id="admin-dismiss-report-btn" class="secondary">Als Erledigt markieren</button>
          </div>
      </div>
  </div>

  <div id="admin-user-report-modal" class="modal-overlay" hidden>
    <div class="modal-content" style="max-width: 550px;">
        <button id="close-admin-user-report-modal-btn" class="close-btn" aria-label="Schließen">&times;</button>
        <h2>Benutzermeldung überprüfen</h2>
        <div id="admin-user-report-details">
          <div>
            <strong>Gemeldeter Benutzer:</strong>
            <a href="#" id="admin-report-user-name-link" class="admin-link"></a>
          </div>
          <p><strong>E-Mail (für Sperrung):</strong> <span id="admin-report-user-email"></span></p>
          <p><strong>Grund:</strong> <span id="admin-report-user-reason"></span></p>
          <p><strong>Beschreibung:</strong></p>
          <div id="admin-report-user-description"></div>
          
          <div id="admin-report-chat-history-container" hidden>
            <p><strong>Beigefügter Chatverlauf (letzte 10 Nachrichten):</strong></p>
            <div id="admin-report-chat-history"></div>
          </div>

        </div>
        <div class="form-actions" style="margin-top: 20px; justify-content: space-between;">
            <button id="admin-deactivate-user-btn" class="button small danger">Konto sperren</button>
            <button id="admin-dismiss-user-report-btn" class="secondary">Als Erledigt markieren</button>
        </div>
        </div>
</div>

  <div id="image-preview-modal" class="modal-overlay" hidden>
    <div class="modal-content" style="max-width: 450px; text-align: center;">
        <h2>Bild senden?</h2>
        <p>Möchtest du dieses Bild wirklich senden?</p>
        <img id="image-preview-content" src="" alt="Vorschaubild" style="max-width: 100%; max-height: 300px; border-radius: 8px; margin: 15px 0;">
        <div class="form-actions" style="justify-content: center; margin-top: 20px;">
            <button id="confirm-send-image-btn" class="button">Senden</button>
            <button id="cancel-send-image-btn" class="secondary">Abbrechen</button>
        </div>
    </div>
  </div>

  <div id="reauth-modal" class="modal-overlay" hidden>
    <div class="modal-content" style="max-width: 420px;">
        <h2 id="reauth-modal-title">Zur Sicherheit bestätigen</h2>
        <p id="reauth-modal-text">Bitte gib dein Passwort erneut ein, um das Konto endgültig zu löschen.</p>
        <form id="reauth-form" style="margin-top: 20px;">
            
            <label style="display: flex; flex-direction: column; gap: 5px; font-weight: 600;">
                Passwort
                <div class="password-wrapper">
                    <input type="password" id="reauth-password" required>
                    <button type="button" id="toggle-reauth-password" class="password-toggle" aria-label="Passwort anzeigen"></button>
                </div>
            </label>
            <div class="form-actions" style="justify-content: center; margin-top: 20px;">
                <button type="submit" id="reauth-modal-confirm-btn" class="danger">Konto endgültig löschen</button>
                <button type="button" id="reauth-modal-cancel-btn" class="secondary">Abbrechen</button>
            </div>
        </form>
    </div>
</div>


  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    // HINZUGEFÜGT: deleteUser
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, sendPasswordResetEmail, updateProfile, sendEmailVerification, deleteUser, EmailAuthProvider, reauthenticateWithCredential } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyB06YP-PZgaviKEVvG_APz8O2ITy6BuvPs",
      authDomain: "help4y-375f6.firebaseapp.com",
      projectId: "help4y-375f6",
      storageBucket: "help4y-375f6.appspot.com",
      messagingSenderId: "251326720035",
      appId: "1:251326720035:web:e540fb9aed31d3dba02996",
      measurementId: "G-MHFQS6DXD5"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);


    window.firebaseAuth = {
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        onAuthStateChanged,
        signOut,
        auth,
        sendPasswordResetEmail,
        updateProfile,
        sendEmailVerification,
        deleteUser,
        EmailAuthProvider,
        reauthenticateWithCredential 
    };

  // HIER IST DIE KORREKTUR: 'increment' und 'limit' werden hinzugefügt
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, onSnapshot, query, orderBy, serverTimestamp, setDoc, updateDoc, getDoc, arrayUnion, arrayRemove, writeBatch, where, increment, limit }
  from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

const db = getFirestore(app);

// Für globale Nutzung
window.firebaseDb = {
    db,
    collection,
    addDoc,
    getDocs,
    deleteDoc,
    doc,
    onSnapshot,
    query,
    orderBy,
    serverTimestamp,
    setDoc,
    updateDoc,
    getDoc,
    arrayUnion,
    arrayRemove,
    writeBatch, 
    where,
    increment,
    limit // HIER IST DIE KORREKTUR: 'limit' wird hinzugefügt
};


  </script>

  <script src="app.js" defer></script>
</body>
</html>